process:
  id: process_cloud_security_compensation
  name: Cloud Infrastructure Provisioning with Security Validation
  subProcessDefinitions: []
  pools:
    - id: pool_1
      name: Cloud Infrastructure Provisioning
      x: 50
      y: 100
      width: 1800
      height: 500
      lanes:
        - id: lane_1
          name: Provisioning & Security
          height: 250
        - id: lane_2
          name: Compensation (Teardown)
          height: 250

  elements:
    # ========================================
    # LANE 1: Main Provisioning Flow
    # ========================================
    - id: start_1
      type: startEvent
      name: Start Provisioning
      x: 100
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        documentation: DevOps team initiates cloud infrastructure provisioning

    # Step 1: Create VPC (Virtual Private Cloud)
    - id: task_create_vpc
      type: scriptTask
      name: Create VPC
      x: 220
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        scriptFormat: python
        script: |
          import time
          print(f"‚òÅÔ∏è  Step 1: Creating VPC (Virtual Private Cloud)...")
          print(f"   Project: {project_name}")
          print(f"   Region: {cloud_region}")
          print(f"   CIDR Block: {vpc_cidr}")
          time.sleep(0.8)
          vpc_id = f"vpc-{workflowInstanceId[:8]}"
          print(f"‚úÖ VPC Created Successfully!")
          print(f"   VPC ID: {vpc_id}")
          print(f"   Status: Available")
          print(f"   Subnets: Creating default subnet...")
          subnet_id = f"subnet-{workflowInstanceId[:8]}"
          print(f"   Subnet ID: {subnet_id}")
          print(f"   Timestamp: {datetime.now(timezone.utc).isoformat()}")
          result = {
            "vpc_id": vpc_id,
            "subnet_id": subnet_id,
            "cidr_block": vpc_cidr,
            "region": cloud_region,
            "status": "available",
            "timestamp": datetime.now(timezone.utc).isoformat()
          }
        resultVariable: vpc_result
        documentation: Create isolated virtual network for cloud resources

    # Compensation boundary for VPC
    - id: comp_vpc
      type: compensationBoundaryEvent
      name: Delete VPC
      x: 265
      y: 235
      poolId: pool_1
      laneId: lane_1
      attachedToRef: task_create_vpc
      properties:
        cancelActivity: false
        documentation: Teardown VPC and all associated networking

    # Step 2: Create Storage (Block Storage Volume)
    - id: task_create_storage
      type: scriptTask
      name: Create Storage Volume
      x: 380
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        scriptFormat: python
        script: |
          import time
          print(f"üíæ Step 2: Creating Block Storage Volume...")
          print(f"   VPC: {vpc_result.get('vpc_id')}")
          print(f"   Size: {storage_size_gb} GB")
          print(f"   Type: {storage_type}")
          print(f"   Encryption: Enabled (AES-256)")
          time.sleep(0.8)
          volume_id = f"vol-{workflowInstanceId[:8]}"
          print(f"‚úÖ Storage Volume Created Successfully!")
          print(f"   Volume ID: {volume_id}")
          print(f"   Size: {storage_size_gb} GB")
          print(f"   IOPS: 3000")
          print(f"   Status: Available")
          print(f"   Timestamp: {datetime.now(timezone.utc).isoformat()}")
          result = {
            "volume_id": volume_id,
            "size_gb": storage_size_gb,
            "volume_type": storage_type,
            "encryption": "AES-256",
            "status": "available",
            "timestamp": datetime.now(timezone.utc).isoformat()
          }
        resultVariable: storage_result
        documentation: Create encrypted block storage for VM instance

    # Compensation boundary for storage
    - id: comp_storage
      type: compensationBoundaryEvent
      name: Delete Storage
      x: 425
      y: 235
      poolId: pool_1
      laneId: lane_1
      attachedToRef: task_create_storage
      properties:
        cancelActivity: false
        documentation: Delete storage volume and destroy data

    # Step 3: Launch VM Instance
    - id: task_launch_vm
      type: scriptTask
      name: Launch VM Instance
      x: 540
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        scriptFormat: python
        script: |
          import time
          print(f"üñ•Ô∏è  Step 3: Launching VM Instance...")
          print(f"   VPC: {vpc_result.get('vpc_id')}")
          print(f"   Subnet: {vpc_result.get('subnet_id')}")
          print(f"   Volume: {storage_result.get('volume_id')}")
          print(f"   Instance Type: {vm_instance_type}")
          print(f"   Image: {vm_image_id}")
          time.sleep(1.0)
          instance_id = f"i-{workflowInstanceId[:8]}"
          instance_ip = f"10.0.1.{workflowInstanceId[:3].count('a') % 255 + 10}"
          public_ip = f"54.{workflowInstanceId[:3].count('b') % 255}.{workflowInstanceId[:3].count('c') % 255}.{workflowInstanceId[:3].count('d') % 255}"
          print(f"‚úÖ VM Instance Launched Successfully!")
          print(f"   Instance ID: {instance_id}")
          print(f"   Private IP: {instance_ip}")
          print(f"   Public IP: {public_ip}")
          print(f"   State: Running")
          print(f"   SSH: Port 22 (Open)")
          print(f"   HTTP: Port 80 (Open)")
          print(f"   HTTPS: Port 443 (Open)")
          print(f"   Timestamp: {datetime.now(timezone.utc).isoformat()}")
          result = {
            "instance_id": instance_id,
            "instance_type": vm_instance_type,
            "private_ip": instance_ip,
            "public_ip": public_ip,
            "state": "running",
            "image_id": vm_image_id,
            "volume_id": storage_result.get('volume_id'),
            "open_ports": [22, 80, 443],
            "timestamp": datetime.now(timezone.utc).isoformat()
          }
        resultVariable: vm_result
        documentation: Launch virtual machine instance with attached storage

    # Compensation boundary for VM
    - id: comp_vm
      type: compensationBoundaryEvent
      name: Terminate VM
      x: 585
      y: 235
      poolId: pool_1
      laneId: lane_1
      attachedToRef: task_launch_vm
      properties:
        cancelActivity: false
        documentation: Shutdown and terminate VM instance

    # Step 4: Security Scan (This is where vulnerability is discovered)
    - id: task_security_scan
      type: scriptTask
      name: Run Security Scan
      x: 700
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        scriptFormat: python
        script: |
          import time
          print(f"üîí Step 4: Running Security Vulnerability Scan...")
          print(f"   Target Instance: {vm_result.get('instance_id')}")
          print(f"   Public IP: {vm_result.get('public_ip')}")
          print(f"   Scanning ports: {vm_result.get('open_ports')}")
          print(f"")
          print(f"   üîç Scanning for vulnerabilities...")
          time.sleep(1.0)
          print(f"   üîç Checking OS patches...")
          time.sleep(0.5)
          print(f"   üîç Scanning installed packages...")
          time.sleep(0.5)
          print(f"   üîç Analyzing security groups...")
          time.sleep(0.5)
          print(f"")

          # Simulate discovering critical vulnerabilities based on context
          has_vulnerabilities = security_scan_should_fail  # Set via context

          if has_vulnerabilities:
              print(f"‚ùå CRITICAL VULNERABILITIES DETECTED!")
              print(f"")
              print(f"   üö® CVE-2024-12345: Remote Code Execution (CRITICAL)")
              print(f"      Severity: 9.8/10 (CVSS)")
              print(f"      Package: openssl-1.0.2 (outdated)")
              print(f"      Impact: Allows remote attackers to execute arbitrary code")
              print(f"      Exploit: Publicly available")
              print(f"")
              print(f"   üö® CVE-2024-67890: Privilege Escalation (HIGH)")
              print(f"      Severity: 8.1/10 (CVSS)")
              print(f"      Package: sudo-1.8.21 (unpatched)")
              print(f"      Impact: Local user can gain root access")
              print(f"")
              print(f"   ‚ö†Ô∏è  CVE-2024-11111: SSH Weak Cipher (MEDIUM)")
              print(f"      Severity: 5.3/10 (CVSS)")
              print(f"      Service: SSH (Port 22)")
              print(f"      Impact: Man-in-the-middle attacks possible")
              print(f"")
              print(f"   üìä SCAN SUMMARY:")
              print(f"      Critical: 1")
              print(f"      High: 1")
              print(f"      Medium: 1")
              print(f"      Total Issues: 3")
              print(f"")
              print(f"   ‚ùó SECURITY POLICY VIOLATION!")
              print(f"   Infrastructure with CRITICAL vulnerabilities cannot be deployed.")
              print(f"   Initiating automatic teardown...")
              print(f"")
              raise Exception("SecurityScanFailure: Critical vulnerabilities detected - infrastructure must be torn down")

          print(f"‚úÖ Security Scan Passed!")
          print(f"   No critical vulnerabilities found")
          print(f"   Instance is compliant with security policies")
          result = {
            "scan_status": "passed",
            "vulnerabilities": [],
            "compliance": "compliant",
            "timestamp": datetime.now(timezone.utc).isoformat()
          }
        resultVariable: security_scan_result
        documentation: Scan VM for security vulnerabilities and compliance

    # Error boundary on security scan - triggers compensation
    - id: error_security_scan
      type: errorBoundaryEvent
      name: Security Scan Failed
      x: 745
      y: 185
      poolId: pool_1
      laneId: lane_1
      attachedToRef: task_security_scan
      properties:
        errorCode: SecurityScanFailure
        cancelActivity: true
        documentation: Catches security scan failures and triggers full infrastructure teardown

    # Success path
    - id: task_register_infra
      type: scriptTask
      name: Register Infrastructure
      x: 860
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        scriptFormat: python
        script: |
          print(f"üìã Registering infrastructure in CMDB...")
          print(f"   VPC: {vpc_result.get('vpc_id')}")
          print(f"   Volume: {storage_result.get('volume_id')}")
          print(f"   Instance: {vm_result.get('instance_id')}")
          print(f"   Public IP: {vm_result.get('public_ip')}")
          print(f"   Security: Compliant")
          print(f"‚úÖ Infrastructure registered and ready for use!")
        documentation: Register infrastructure in Configuration Management Database

    - id: task_notify_success
      type: sendTask
      name: Send Success Notification
      x: 1020
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        messageType: Email
        to: ${devops_team_email}
        subject: "‚úÖ Cloud Infrastructure Provisioned - ${project_name}"
        messageBody: |
          Hello DevOps Team,

          Your cloud infrastructure has been successfully provisioned and passed all security checks!

          PROJECT: ${project_name}
          REGION: ${cloud_region}

          INFRASTRUCTURE DETAILS:

          ‚òÅÔ∏è  VPC (VIRTUAL PRIVATE CLOUD)
             VPC ID: ${vpc_result.vpc_id}
             Subnet ID: ${vpc_result.subnet_id}
             CIDR Block: ${vpc_result.cidr_block}
             Status: ${vpc_result.status}

          üíæ STORAGE VOLUME
             Volume ID: ${storage_result.volume_id}
             Size: ${storage_result.size_gb} GB
             Type: ${storage_result.volume_type}
             Encryption: ${storage_result.encryption}
             Status: ${storage_result.status}

          üñ•Ô∏è  VM INSTANCE
             Instance ID: ${vm_result.instance_id}
             Instance Type: ${vm_result.instance_type}
             Private IP: ${vm_result.private_ip}
             Public IP: ${vm_result.public_ip}
             State: ${vm_result.state}
             Image: ${vm_result.image_id}

          üîí SECURITY VALIDATION
             Scan Status: PASSED ‚úÖ
             Vulnerabilities: None
             Compliance: Compliant

          ACCESS INFORMATION:
          SSH: ssh admin@${vm_result.public_ip}
          HTTP: http://${vm_result.public_ip}
          HTTPS: https://${vm_result.public_ip}

          Your infrastructure is now live and ready for deployment!

          Cloud Automation Team
        useGmail: true
        htmlFormat: false
        documentation: Notify team of successful provisioning

    - id: end_success
      type: endEvent
      name: Provisioning Complete
      x: 1180
      y: 210
      poolId: pool_1
      laneId: lane_1
      properties:
        documentation: Infrastructure successfully provisioned and validated

    # ========================================
    # Error Path - Security Failure
    # ========================================
    - id: task_log_security_failure
      type: scriptTask
      name: Log Security Violation
      x: 860
      y: 130
      poolId: pool_1
      laneId: lane_1
      properties:
        scriptFormat: python
        script: |
          print(f"")
          print(f"üö® ========================================")
          print(f"üö® SECURITY POLICY VIOLATION DETECTED")
          print(f"üö® ========================================")
          print(f"   Project: {project_name}")
          print(f"   Instance: {vm_result.get('instance_id') if vm_result else 'N/A'}")
          print(f"   Public IP: {vm_result.get('public_ip') if vm_result else 'N/A'}")
          print(f"   Violation: Critical vulnerabilities detected")
          print(f"   Action: Initiating EMERGENCY TEARDOWN")
          print(f"üö® ========================================")
          print(f"")
        documentation: Log security violation for audit and compliance

    - id: comp_throw
      type: compensationIntermediateThrowEvent
      name: Emergency Teardown
      x: 1020
      y: 130
      poolId: pool_1
      laneId: lane_1
      properties:
        documentation: Triggers compensation - tears down ALL infrastructure in reverse order

    - id: task_notify_security_failure
      type: sendTask
      name: Send Security Alert
      x: 1180
      y: 130
      poolId: pool_1
      laneId: lane_1
      properties:
        messageType: Email
        to: ${devops_team_email}
        subject: "üö® SECURITY ALERT - Infrastructure Teardown - ${project_name}"
        messageBody: |
          üö® SECURITY ALERT - CRITICAL VULNERABILITIES DETECTED üö®

          PROJECT: ${project_name}
          REGION: ${cloud_region}
          ACTION: EMERGENCY INFRASTRUCTURE TEARDOWN

          SECURITY SCAN RESULTS:
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

          ‚ùå CRITICAL VULNERABILITIES DETECTED

          üö® CVE-2024-12345: Remote Code Execution (CRITICAL)
             Severity: 9.8/10 (CVSS)
             Package: openssl-1.0.2 (outdated)
             Impact: Allows remote attackers to execute arbitrary code
             Exploit: Publicly available

          üö® CVE-2024-67890: Privilege Escalation (HIGH)
             Severity: 8.1/10 (CVSS)
             Package: sudo-1.8.21 (unpatched)
             Impact: Local user can gain root access

          ‚ö†Ô∏è  CVE-2024-11111: SSH Weak Cipher (MEDIUM)
             Severity: 5.3/10 (CVSS)
             Service: SSH (Port 22)
             Impact: Man-in-the-middle attacks possible

          SUMMARY:
          ‚Ä¢ Critical: 1
          ‚Ä¢ High: 1
          ‚Ä¢ Medium: 1
          ‚Ä¢ Total Issues: 3

          AUTOMATIC TEARDOWN COMPLETED:
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

          The following infrastructure was automatically torn down to prevent
          security exposure:

          üñ•Ô∏è  VM INSTANCE TERMINATED
             Instance ID: ${vm_result.instance_id}
             Public IP: ${vm_result.public_ip}
             Status: TERMINATED ‚úÖ
             Data: Wiped

          üíæ STORAGE VOLUME DELETED
             Volume ID: ${storage_result.volume_id}
             Size: ${storage_result.size_gb} GB
             Status: DELETED ‚úÖ
             Data: Securely erased

          ‚òÅÔ∏è  VPC DELETED
             VPC ID: ${vpc_result.vpc_id}
             Subnet ID: ${vpc_result.subnet_id}
             Status: DELETED ‚úÖ
             Network: Cleaned up

          NEXT STEPS:
          ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

          1. Update VM image to patch vulnerabilities
          2. Use hardened base image with latest security updates
          3. Re-run provisioning workflow with updated image
          4. Ensure all packages are up-to-date

          SECURITY POLICY:
          Infrastructure with CRITICAL vulnerabilities cannot be deployed.
          All resources have been automatically cleaned up to prevent exposure.

          Security & Compliance Team
        useGmail: true
        htmlFormat: false
        documentation: Send security alert notification to DevOps team

    - id: end_failure
      type: endEvent
      name: Teardown Complete
      x: 1340
      y: 130
      poolId: pool_1
      laneId: lane_1
      properties:
        documentation: Infrastructure torn down due to security violations

    # ========================================
    # LANE 2: Compensation Flows (LIFO Teardown)
    # ========================================
    # These execute in REVERSE order: VM ‚Üí Storage ‚Üí VPC

    # Compensation Task 3: Terminate VM (EXECUTES FIRST - most recent)
    - id: task_terminate_vm
      type: scriptTask
      name: Terminate VM Instance
      x: 540
      y: 420
      poolId: pool_1
      laneId: lane_2
      properties:
        scriptFormat: python
        script: |
          import time
          instance_id = vm_result.get('instance_id') if vm_result else 'UNKNOWN'
          public_ip = vm_result.get('public_ip') if vm_result else 'N/A'
          print(f"")
          print(f"üîÑ ========================================")
          print(f"üîÑ COMPENSATION STEP 1 (of 3)")
          print(f"üîÑ Terminating VM INSTANCE (most recent)")
          print(f"üîÑ ========================================")
          print(f"   Instance ID: {instance_id}")
          print(f"   Public IP: {public_ip}")
          print(f"   State: Running ‚Üí Shutting Down...")
          time.sleep(0.5)
          print(f"   ‚úÖ Instance stopped")
          print(f"   ‚úÖ Detaching storage volumes...")
          time.sleep(0.3)
          print(f"   ‚úÖ Releasing public IP address")
          print(f"   ‚úÖ Removing security group rules")
          print(f"   ‚úÖ Instance terminated")
          print(f"   ‚úÖ State: Terminated")
          print(f"   ‚úÖ All instance data wiped")
          print(f"üîÑ ========================================")
        documentation: Shutdown and terminate VM instance - undo VM launch

    # Compensation Task 2: Delete Storage (EXECUTES SECOND)
    - id: task_delete_storage
      type: scriptTask
      name: Delete Storage Volume
      x: 380
      y: 420
      poolId: pool_1
      laneId: lane_2
      properties:
        scriptFormat: python
        script: |
          import time
          volume_id = storage_result.get('volume_id') if storage_result else 'UNKNOWN'
          size_gb = storage_result.get('size_gb') if storage_result else 0
          print(f"")
          print(f"üîÑ ========================================")
          print(f"üîÑ COMPENSATION STEP 2 (of 3)")
          print(f"üîÑ Deleting STORAGE VOLUME")
          print(f"üîÑ ========================================")
          print(f"   Volume ID: {volume_id}")
          print(f"   Size: {size_gb} GB")
          print(f"   Status: Available ‚Üí Deleting...")
          time.sleep(0.5)
          print(f"   ‚úÖ Creating final snapshot (optional)...")
          print(f"   ‚úÖ Securely erasing data...")
          print(f"   ‚úÖ Volume deleted")
          print(f"   ‚úÖ Storage quota released")
          print(f"   ‚úÖ All data permanently destroyed")
          print(f"üîÑ ========================================")
        documentation: Delete storage volume and destroy data - undo storage creation

    # Compensation Task 1: Delete VPC (EXECUTES LAST - oldest step)
    - id: task_delete_vpc
      type: scriptTask
      name: Delete VPC & Network
      x: 220
      y: 420
      poolId: pool_1
      laneId: lane_2
      properties:
        scriptFormat: python
        script: |
          import time
          vpc_id = vpc_result.get('vpc_id') if vpc_result else 'UNKNOWN'
          subnet_id = vpc_result.get('subnet_id') if vpc_result else 'UNKNOWN'
          print(f"")
          print(f"üîÑ ========================================")
          print(f"üîÑ COMPENSATION STEP 3 (of 3)")
          print(f"üîÑ Deleting VPC & NETWORK (oldest step)")
          print(f"üîÑ ========================================")
          print(f"   VPC ID: {vpc_id}")
          print(f"   Subnet ID: {subnet_id}")
          print(f"   Status: Available ‚Üí Deleting...")
          time.sleep(0.5)
          print(f"   ‚úÖ Deleting subnet: {subnet_id}")
          print(f"   ‚úÖ Releasing route tables")
          print(f"   ‚úÖ Removing network ACLs")
          print(f"   ‚úÖ Deleting internet gateway")
          print(f"   ‚úÖ VPC deleted: {vpc_id}")
          print(f"   ‚úÖ All networking resources cleaned up")
          print(f"üîÑ ========================================")
          print(f"")
          print(f"‚úÖ EMERGENCY TEARDOWN COMPLETE - All 3 resources destroyed in LIFO order")
          print(f"   Infrastructure state: Fully cleaned up")
          print(f"   No vulnerable resources remain deployed")
          print(f"")
        documentation: Delete VPC and all networking - undo VPC creation

  connections:
    # Main flow
    - id: flow_1
      type: sequenceFlow
      name: ""
      from: start_1
      to: task_create_vpc
      properties: {}

    - id: flow_2
      type: sequenceFlow
      name: ""
      from: task_create_vpc
      to: task_create_storage
      properties: {}

    - id: flow_3
      type: sequenceFlow
      name: ""
      from: task_create_storage
      to: task_launch_vm
      properties: {}

    - id: flow_4
      type: sequenceFlow
      name: ""
      from: task_launch_vm
      to: task_security_scan
      properties: {}

    - id: flow_5
      type: sequenceFlow
      name: Security Passed
      from: task_security_scan
      to: task_register_infra
      properties: {}

    - id: flow_6
      type: sequenceFlow
      name: ""
      from: task_register_infra
      to: task_notify_success
      properties: {}

    - id: flow_7
      type: sequenceFlow
      name: ""
      from: task_notify_success
      to: end_success
      properties: {}

    # Error path (security failure)
    - id: flow_error_1
      type: sequenceFlow
      name: Security Failed
      from: error_security_scan
      to: task_log_security_failure
      properties: {}

    - id: flow_error_2
      type: sequenceFlow
      name: ""
      from: task_log_security_failure
      to: comp_throw
      properties: {}

    - id: flow_error_3
      type: sequenceFlow
      name: After Teardown
      from: comp_throw
      to: task_notify_security_failure
      properties: {}

    - id: flow_error_4
      type: sequenceFlow
      name: ""
      from: task_notify_security_failure
      to: end_failure
      properties: {}

    # Compensation flows (triggered by comp_throw in LIFO order)
    - id: flow_comp_vpc
      type: sequenceFlow
      name: Undo VPC (LAST)
      from: comp_vpc
      to: task_delete_vpc
      properties: {}

    - id: flow_comp_storage
      type: sequenceFlow
      name: Undo Storage (SECOND)
      from: comp_storage
      to: task_delete_storage
      properties: {}

    - id: flow_comp_vm
      type: sequenceFlow
      name: Undo VM (FIRST)
      from: comp_vm
      to: task_terminate_vm
      properties: {}
